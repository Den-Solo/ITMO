к исходной строке дописываем справа ее саму (т. о. строка удвоенной длины)

используем алгоритм кнута-морриса-пратта