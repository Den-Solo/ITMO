1) запишем начала и концы отрезков в вектор пар, притом только те, где левая граница левее правой базового орезка, а правая правее левой границы базового отрезка.

2)отсортируем отрезки лексикографически
3) заведем массив пар rightest_edges[i], который хранит максимально правую границу для отрезков с левой координатой l <= i и индекс такого отрезка
4) проходимся по отсортировнанному вектору отрезков 
rightest_edges[j] = max(rightest_edges[j - 1].r, segments[i].r), где
segments[i] такое , что segments[i].l <= j
